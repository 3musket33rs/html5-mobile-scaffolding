<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>Html5 Mobile Scaffolding Plugin 0.4</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
    </head>

    <body class="body" onload="addJsClass();">
        <div id="navigation">
            <ul>
                <li>
                    <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                        <a href="../guide/index.html" class="button">Table of contents</a>
                        <div id="nav-summary-childs" style="display:none;">
                            
                            <div class="toc-item" style="margin-left:0"><a href="#1%20Introduction%20to%20HTML5%20mobile%20scaffolding%20Plugin"><strong>1</strong><span>Introduction to HTML5 mobile scaffolding Plugin</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#2%20Getting%20Started"><strong>2</strong><span>Getting Started</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#3%20Reference"><strong>3</strong><span>Reference</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#4%20Configuration"><strong>4</strong><span>Configuration</span></a></div>
                            
                        </div>
                    </div>
                </li>
                <li class="separator selected">
                    <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
                </li>
            </ul>
        </div>
        <div id="header">
            <div class="images clearfix">
                
                
            </div>
            <p>
A plugin that scaffold HTML5 mobile application using JQuery mobile in one-page. No GSP anymore.
</p>
        </div>


        <table id="colset" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td id="col1">
                    <div id="main" class="corner-all">

                        <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                        <div class="project">
                            <h1>Html5 Mobile Scaffolding Plugin - Reference Documentation</h1>
                            <p><strong>Authors:</strong> 3.musket33rs</p>
                            <p><strong>Version:</strong> 0.4</p>
                            
                        </div>

                        
                        <div id="table-of-content">
                            <h2>Table of Contents</h2>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#1%20Introduction%20to%20HTML5%20mobile%20scaffolding%20Plugin"><strong>1</strong><span>Introduction to HTML5 mobile scaffolding Plugin</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.1%20HTML5%20single%20page"><strong>1.1</strong><span>HTML5 single page</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.2%20Responsive%20UI,%20Progressive%20enhancement%20with%20jQuery%20Mobile"><strong>1.2</strong><span>Responsive UI, Progressive enhancement with jQuery Mobile</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.3%20MCV%20pattern%20going%20to%20client%20side"><strong>1.3</strong><span>MCV pattern going to client side</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.4%20Working%20offline"><strong>1.4</strong><span>Working offline</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.5%20Back%20online%20and%20Synchronization"><strong>1.5</strong><span>Back online and Synchronization</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.6%20Geolocation"><strong>1.6</strong><span>Geolocation</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.7%20Scaffolding"><strong>1.7</strong><span>Scaffolding</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.8%20Hybrid"><strong>1.8</strong><span>Hybrid</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#2%20Getting%20Started"><strong>2</strong><span>Getting Started</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#2.1%20How%20to%20install%20?"><strong>2.1</strong><span>How to install ?</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#2.2%20What%20is%20it?"><strong>2.2</strong><span>What is it?</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#2.3%20Quick%20sample"><strong>2.3</strong><span>Quick sample</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#2.4%20What%20is%20generated?"><strong>2.4</strong><span>What is generated?</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#3%20Reference"><strong>3</strong><span>Reference</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#3.1%20Scaffolding"><strong>3.1</strong><span>Scaffolding</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#3.2%20How%20to%20customize%20MVC"><strong>3.2</strong><span>How to customize MVC</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#3.3%20Geolocation"><strong>3.3</strong><span>Geolocation</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#3.4%20Offline%20support"><strong>3.4</strong><span>Offline support</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#3.5%20Synchronization"><strong>3.5</strong><span>Synchronization</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#3.6%20Push%20notifications"><strong>3.6</strong><span>Push notifications</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#4%20Configuration"><strong>4</strong><span>Configuration</span></a></div>
                            
                            <div style="clear:both" ></div>
                        </div>
                        
                        

<h1 id="1 Introduction to HTML5 mobile scaffolding Plugin">1 Introduction to HTML5 mobile scaffolding Plugin</h1>
The HTML5 mobile scaffolding plugin makes it easy to generate your first HTML5 mobile application. In a minute you can scaffold a skeleton for your mobile application that contains all you need for CRUD operations.


<h2 id="1.1 HTML5 single page">1.1 HTML5 single page</h2>
HTML5 alone might still be the future not yet the present (Mr Zuckerberg), but HTML5 with Apache Cordova is the present answer for Hybrid Mobile Apps. What does it take to write Hybrid Mobile Apps?<p class="paragraph"/>First of all, you need to forget about server side templating. If you want ot be able to package your app in Hybrid app, support offline mode&#8230; You need a rich client.<p class="paragraph"/>No GSP here. 
Vanilla HTML5 (which also means JavaScript) or use it with your preferres JS framework. 3musket33rs is working on scaffolding with AngularJS (comming soon, stay tune).<p class="paragraph"/>Let’s have a tour. 


<h2 id="1.2 Responsive UI, Progressive enhancement with jQuery Mobile">1.2 Responsive UI, Progressive enhancement with jQuery Mobile</h2>
Key benefit of HTML5 mobile Apps is "Write once, Run everywhere"… But don't get into the pitfall: "Write once, Sucks everywhere".<p class="paragraph"/>With the various screen sizes, responsive web design is such a hot topic. Split you screen in different blocks, visualize either two consecutive blocks in vertical mode or two spans aligned together in horizontal mode. <a href="http://jquerymobile.com/" target="blank">jQuery Mobile</a> is handling all that for you. Thanks Html5-mobile-plugin is powered by jQuery Mobile :)


<h2 id="1.3 MCV pattern going to client side">1.3 MCV pattern going to client side</h2>
Nowadays there is a plethora of MV* framework around, I recommend you to the excellent <a href="http://todomvc.com/" target="blank">TODO web site</a> from Addy Osmani to know which one to use.<p class="paragraph"/>3musket33rs has implemented a very basic MVC and provides mobile services. 
If you want to use the MV* JavaScript framework of your choice, you can implement the MVC logic of your own and use 3musket33rs offline/online synch, push notification.<p class="paragraph"/><blockquote class="note">
New 3musket33rs plugin angular-mobile-scaffolding (for the popular <a href="http://angularjs.org/" target="blank">AngularJS</a>) is ongoing.
</blockquote>


<h2 id="1.4 Working offline">1.4 Working offline</h2>
RIA web application can implement offline mode. Wikipedia achieve offline mode by using HTML5 caching. Detecting offline/online event is also part of HTML5 specifications.
But caching is not enough if your application handles and store new data.<p class="paragraph"/>When receiving an offline event from either user selection or browser detection, View notifies Controller which notifies Feeder. Feed is switched to offline mode. When saving, updating or deleting in offline mode, data are visualy marked as yellow.<p class="paragraph"/><img border="0" class="center" src="../img/figure8.png"></img><p class="paragraph"/>When offline, data are stored and retrieved from localStorage using Store abstraction class. At the same time than saving domain data, a journal is maintained with dirty stated and operation type. This journal will drive the synchronization when back online. If you want to see the offline storage, open your browser console and type in:<p class="paragraph"/><div class="code"><pre>localStorage</pre></div>


<h2 id="1.5 Back online and Synchronization">1.5 Back online and Synchronization</h2>
Upon receiving an online event, Feed is switched to online mode. All new entries is sent directly to the server controller through ajax call.<p class="paragraph"/><img border="0" class="center" src="../img/figure3.png"></img><p class="paragraph"/>SynchManager is also listening for online event. When online, synchronization is triggered.
Synchronization looks for all items in Store that are flagged as NOT-SYNC. As reconciliation happens, records are removed from local storage, sent to server with ajax call and on success are added to the model.



<h2 id="1.6 Geolocation">1.6 Geolocation</h2>
Add geolocation with html5-mobile-scaffolding is really easy: it’s all about convention. Just add to your domain class the attributes: longitude, latitude. The plugin uses Google Map API.
JavaScript class grails.mobile.map.googleMapService contains all methods needed to display a map, add markers to it, drag and drop them, geolocate current position, recenter the map.


<h2 id="1.7 Scaffolding">1.7 Scaffolding</h2>
Scaffolding is the strength of Grails. The core 3musket33rs plugin is powered by Grails static scaffolding, allowing creation of CRUD mobile user interface within no time.<p class="paragraph"/>html5-mobile-scaffolding provides a way to scaffold a web app in minutes. It is plugged to the default mechanism copying templates into your project src/templates folder


<h2 id="1.8 Hybrid">1.8 Hybrid</h2>
Abracadabra web app transforms you into Android app. It’s easy with the support of PhoneGap build. In the suite of 3musket33rs mobile plugin, there is PhonegapBuild plugin just for that purpose: packaging your web app into an app-store read app available on iOS, Android™, Windows® Phone, Blackberry®, webOS and Symbian.


<h1 id="2 Getting Started">2 Getting Started</h1>
Let's start with installing the plugin, get a brief description of what it is.  
Let's give it a trial. Follow the guide to build a geolocalized mobile application in a minute and have lots of fun.


<h2 id="2.1 How to install ?">2.1 How to install ?</h2>
Ideally, add the plugin dependency into <code>BuildConfig.groovy</code>. It is important that the plugin is scoped as <code>compile</code>, otherwise you may get some unexpected problems if you are letting the plugin manage your datasource config:<p class="paragraph"/><div class="code"><pre>plugins &#123;
   compile ':html5&#45;mobile&#45;scaffolding:0.6'
&#125;</pre></div><p class="paragraph"/>Alternately you can use the install-plugin command in grails:<p class="paragraph"/><div class="code"><pre>grails install&#45;plugin html5&#45;mobile&#45;scaffolding</pre></div>



<h2 id="2.2 What is it?">2.2 What is it?</h2>
Grails supports a feature known as static scaffolding which involves the generation of a CRUD (Create/Read/Update/Delete) interface for a given domain class. Once generated, the controller can be modified by you but they won't automatically update when you change the domain class.<p class="paragraph"/>Generating HTML5 web mobile application is as easy as using standard Grails scaffolding. Html5-mobile-scaffolding is using static scaffolding. The idea is to give you the skeleton of the application for CRUD operation and then it's up to you to modify it.<p class="paragraph"/>As html5-mobile-scaffolding plugin targets mobile application, the challenge is to scaffold an application that can be fully installed as an hybrid application using PhoneGap build or Cordova command line. The controller part is minimal and serves RESTfull services as JSON. 



<h2 id="2.3 Quick sample">2.3 Quick sample</h2>
<h4>Create a Grails project</h4><p class="paragraph"/><h5>using command line or you favoutrite IDE</h5><p class="paragraph"/><div class="code"><pre>grails create&#45;app bookstore
cd bookstore</pre></div><p class="paragraph"/><h5>install HTML5 scaffolding plugins</h5><p class="paragraph"/>Our plugin is not yet publish in grails repository, in the meantime
<ul class="star">
<li>fork or clone projects from github.com/3musket33rs/htm5-mobile-scaffolding</li>
<li>add <code>jsonp</code> and <code>html5-mobile-scaffolding</code> dependencies to BuildConfig.groovy file</li>
</ul><p class="paragraph"/>jsonp plugin is for cross domain application. If you want to package your application as an hybrid application, this dependency is required.<p class="paragraph"/><h4>Create a domain class</h4>
<div class="code"><pre>grails create&#45;domain&#45;class bookstore.Book</pre></div><p class="paragraph"/><h5>add content to it</h5><p class="paragraph"/><div class="code"><pre>class Book &#123;
    <span class="java&#45;object">String</span> name
    <span class="java&#45;object">String</span> isbn
    <span class="java&#45;object">Double</span> latitude
    <span class="java&#45;object">Double</span> longitude
    <span class="java&#45;keyword">static</span> constraints = &#123;&#125;
&#125;</pre></div><p class="paragraph"/><h5>geolocalization</h5><p class="paragraph"/>To enable geolocalization add attributes <code>latitude</code> and <code>longitude</code> as Double. By convention, the plugin will understand those attributes as geolocalized information and will scaffold using a google map.<p class="paragraph"/><h4>Generate JSON Controller and HTML view</h4><p class="paragraph"/>You can generate both in one go:<p class="paragraph"/><div class="code"><pre>grails html&#45;generate&#45;all bookstore.Book</pre></div><p class="paragraph"/><h4>Launch the application</h4><p class="paragraph"/><div class="code"><pre>grails run&#45;app</pre></div><p class="paragraph"/>Whith geolocation activated, book list can be rendered as map (default render)<p class="paragraph"/><img border="0" class="center" src="../img/book-as-map-geolocation.png"></img><p class="paragraph"/>You can switch to list rendering:<p class="paragraph"/><img border="0" class="center" src="../img/book-as-list-geolocation.png"></img>



<h2 id="2.4 What is generated?">2.4 What is generated?</h2>
<h5>Generated Controller</h5><p class="paragraph"/>From domain class controller class is generated. Controller renders as JSON.
<div class="code"><pre>def list() &#123;
      params.max = <span class="java&#45;object">Math</span>.min(params.max ? params.<span class="java&#45;object">int</span>('max') : 10, 100)
     	render Book.list(params) as JSON
    &#125;</pre></div><p class="paragraph"/><h5>Generated views</h5><p class="paragraph"/>Views are generated in web-app directory. for each domain class one html file will be generated. This file contains different sections for each CRUD operations. 2 associated JavaScript files are generated.<p class="paragraph"/><div class="code"><pre>&#45; web&#45;app
  book&#45;index.html
  &#45; js
    &#45; bookstore &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; Folder to customize
      configuration&#45;bootstrap.js
      manager&#45;bootstrap.js
      &#45; bootstrap
        book&#45;bootstrap.js &#45;&#45;&#45;&#45;&#45;&#45;&#62; describe your domain class relationships 
      &#45; controller 
        book&#45;controller.js&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; add methods other than CRUD
      &#45; model 
        book&#45;model.js &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; entry point to enhance model
      &#45; view
        book&#45;view.js &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; entry point to enhance view
    &#45; grails.mobile &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; 3musketeers Mobile Framework
      &#45; camera
      &#45; feed
      &#45; map
      &#45; mvc
      &#45; push
      &#45; storage
      &#45; sync</pre></div>


<h1 id="3 Reference">3 Reference</h1>
Because it's always better to illustrate with code, our reference manual is based on tutorial application <a href="https://github.com/3musket33rs/ThreeCircles" target="blank">ThreeCircles</a>.<p class="paragraph"/><h4>Hybrid Mobile App in minutes not days</h4><p class="paragraph"/>Can you build your own version of Foursquare in minutes? Yes, you can. To survive offline your presentation logic should reside on the client. Using HTML5 power and jQuery mobile responsive UI your web app becomes Mobile. Ready to take the mobile challenges: geolocation, offline caching, data synchronization, server side event push, camera and packaging as Hybrid using PhoneGap. At the end of the session, you will have a clone of Foursquare on your mobile, with a REST backend in Grails running on the cloud. All that with one goal in mind: have fun! 


<h2 id="3.1 Scaffolding">3.1 Scaffolding</h2>
Read scripts description:
<ul class="minus">
<li>guide:html-generate-all</li>
<li>guide:html-generate-controllers</li>
<li>guide:html-generate-views</li>
</ul><p class="paragraph"/>Refer to <a href="https://github.com/3musket33rs/ThreeCircles#step1-scaffolding" target="blank">step1</a>  of tutorial


<h2 id="3.2 How to customize MVC">3.2 How to customize MVC</h2>
3musket33rs includes a very easy custom MCV in JavaScript. As we've seen ealier this MCV catters for the default CRUD operations. For exemple see the update flow explained below:<p class="paragraph"/><img border="0" class="center" src="../img/mvc.png"></img><p class="paragraph"/>Most of the time those CRUD operations could be enough for your need. Most of the times, even without adding new method you do need cutomization to write your view your own way.<p class="paragraph"/>Going back to the directory structure:<p class="paragraph"/><div class="code"><pre>&#45; web&#45;app
  place&#45;index.html
  &#45; js
    &#45; threecircles &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; Folder to customize
      configuration&#45;bootstrap.js
      manager&#45;bootstrap.js
      &#45; bootstrap
        place&#45;bootstrap.js &#45;&#45;&#45;&#45;&#45;&#45;&#62; describe your domain class relationships 
      &#45; controller 
        place&#45;controller.js&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; add methods other than CRUD
      &#45; model 
        place&#45;model.js &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; entry point to enhance model
      &#45; view
        place&#45;view.js &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; entry point to enhance view
    &#45; grails.mobile &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#62; 3musketeers Mobile Framework
      &#45; camera
      &#45; feed
      &#45; map
      &#45; mvc
      &#45; push
      &#45; storage
      &#45; sync</pre></div><p class="paragraph"/>To customize your view, you will modify scaffolded code in:
<ul class="minus">
<li>js/threecircles/view/place-view.js</li>
</ul><p class="paragraph"/><blockquote class="note">
 A default view is generated for you by the scaffolding. It uses jQuery mobile. It's up to you to customize it.
 For controller and model, if you only use CRUD server side operation, you don't need to extends Controller or Model.
</blockquote><p class="paragraph"/>Suppose now that we want to add a new verb, let's say for exemple: login. We need to extend Controller to do our cutom ajax call. Extending Controller could be enough if we don't need to store any data in the model.<p class="paragraph"/>If we want to add data to the model (like let's say the firstname of the user logged) we need to extend Model. 
In the directory structure, you will use the generated files (empty for now):
<ul class="minus">
<li>js/threecircles/view/place-model.js</li>
<li>js/threecircles/view/place-controller.js</li>
</ul><p class="paragraph"/>Refer to <a href="https://github.com/3musket33rs/ThreeCircles#step9-login" target="blank">step9</a> of tutorial for an exemple of implementation.


<h2 id="3.3 Geolocation">3.3 Geolocation</h2>
<h4>Double longitude latitude convention</h4>
By convention if you define 2 attributes: longitude and latitude as double, the plugin will know those attribute contains geolocation information. When doing a create, the browser will search your location.<p class="paragraph"/><div class="code"><pre>class Place &#123;
    <span class="java&#45;object">String</span> name
    <span class="java&#45;object">Double</span> latitude
    <span class="java&#45;object">Double</span> longitude
    <span class="java&#45;keyword">static</span> constraints = &#123;&#125;
&#125;</pre></div><p class="paragraph"/><h4>with MongoDB indexing</h4>
When using MongoDB you can use a different convention to stick with MongoDB plugin. Location is expressed by a list of latitude and longitude. As shown below:<p class="paragraph"/><div class="code"><pre>class Place &#123;
    <span class="java&#45;object">String</span> name
	List location
	<span class="java&#45;keyword">static</span> mapping = &#123;
   		location geoIndex: <span class="java&#45;keyword">true</span>
	&#125;
    <span class="java&#45;keyword">static</span> constraints = &#123;&#125;
&#125;</pre></div>


<h2 id="3.4 Offline support">3.4 Offline support</h2>
To enable offline support at domain class level, open  <em class="italic"><strong class="bold">js/threecircles/bootstrap/place-bootstrap.js</strong></em>  file and check  <em class="italic"><strong class="bold">offline</strong></em>  is set to true.<p class="paragraph"/><div class="code"><pre>threecircles.configuration.domain.push(&#123;
        name: 'place',
        view: &#123;
			&#8230;
        &#125;,
        options: &#123;
            offline: <span class="java&#45;keyword">true</span>,
            eventPush: <span class="java&#45;keyword">true</span>
        &#125;<p class="paragraph"/>    &#125;</pre></div><p class="paragraph"/>When on, each create/update/delete operation is saved on your local storage whether you are online or offline. when online the operation is also send to the server. When going under a tunel and loosing the connexion, your browser detects offline mode, 3musket33rs Feed service switch to offline mode and won't send the data to the server. Instead it offlinefeed will store the dirty state of the data on your device storage.<p class="paragraph"/>To render a visual effect we display the data using jQuery yellow thme, so you know you've lost the connexion and which data will need synchronization.<p class="paragraph"/>What will happen when back online?
Keep cool, 3mukst33rs services provides data synchronization :-)


<h2 id="3.5 Synchronization">3.5 Synchronization</h2>
For now, Synchronization is in its simpliest model: unidirectional.<p class="paragraph"/>SyncManager implements <strong class="bold">one way synch with optimistic locking</strong>. Granularity is set to domain class. Using Grails instance version mechanism, when online mobile devices get notified (push notification) of other server updates and get a version of the doamain object.<p class="paragraph"/>When offline, modifications are stored locally. Back online, SyncManager triggers sync. Server can reject updates if the version number from the mobile device is different from the server one. At the moment, there is no smart fine-grained reconciliation.<p class="paragraph"/><blockquote class="note">
html5-mobile-scaffolding v0.6 contains first implementation of Synch Manager. 
Later implementation will allows configuration of Synchronization stategies. More to come, stay tune&#8230;
</blockquote>


<h2 id="3.6 Push notifications">3.6 Push notifications</h2>
<h3>When do you need it?</h3>
If you're working on a real-time multi-user application, like our ThreeCircles tutorial, you want to be notified when somebody else does a checkin. How can you do it nicely without polling your server?<p class="paragraph"/>Based on event-push Grails plugin (which uses Atmosphere framework on SSE protocol), html5-mobile-scaffoling provides support for server side push. By default, create/update/delete will raise anEvent on Groovy controller.<p class="paragraph"/><h3>How to use it server side?</h3>
Event push are white listed in the file:<p class="paragraph"/><div class="code"><pre>grails&#45;app/conf/PlaceEvents.groovy</pre></div><p class="paragraph"/>which contains the following decalaration:<p class="paragraph"/><div class="code"><pre>events = &#123;
    'save&#45;place' browser:<span class="java&#45;keyword">true</span>
    'update&#45;place' browser:<span class="java&#45;keyword">true</span>
    'delete&#45;place' browser:<span class="java&#45;keyword">true</span>
&#125;</pre></div><p class="paragraph"/>Events are thrown in each controller like:<p class="paragraph"/><div class="code"><pre>def save() &#123;
      &#8230;
      def asJson = placeInstance as JSON
      event topic:<span class="java&#45;quote">"save&#45;place"</span>, data: asJson.toString()
      &#8230;
    &#125;</pre></div><p class="paragraph"/>If you need to add new push event, you should add then to the white list and raise them when needed.<p class="paragraph"/><h3>How to configure it on the client?</h3>
To enable push notification at domain class level, open  <em class="italic"><strong class="bold">js/threecircles/bootstrap/place-bootstrap.js</strong></em>  file and check  <em class="italic"><strong class="bold">eventPush</strong></em>  is set to true.<p class="paragraph"/><div class="code"><pre>threecircles.configuration.domain.push(&#123;
        name: 'place',
        view: &#123;
			&#8230;
        &#125;,
        options: &#123;
            offline: <span class="java&#45;keyword">true</span>,
            eventPush: <span class="java&#45;keyword">true</span>
        &#125;<p class="paragraph"/>    &#125;</pre></div><p class="paragraph"/>PushManager is the client service implementation. In its first implementation PushManager is implemented as a broadcast. On receiving (for example) <strong class="bold">save-place</strong> event, Push Manager will update the data model (filtering its own eveant is done for you).<p class="paragraph"/>if offline support is on it will update local storage too. PushManager also enhances data model with a NOTIFED boolean attribute so you know this callback is coming from broadcast push notification.<p class="paragraph"/><h3>Hybrid support</h3>
As shown in the the following tables:
<ul class="minus">
<li><a href="http://caniuse.com/#feat=eventsource" target="blank">SSE browsers support</a></li>
<li><a href="http://caniuse.com/#feat=websockets" target="blank">WebSockets browsers support</a></li>
</ul><p class="paragraph"/>Most <strong class="bold">modern</strong> browsers supports SSE but not the Android browser. As a result, current 3musket33rs Push notification is not available for Hybrid app.<p class="paragraph"/><blockquote class="note">
3musket33rs team is writing a Cordova plugin to provide Push notification support on Hybrid Android applications. Stay tune.
</blockquote><p class="paragraph"/><p class="paragraph"/>


<h1 id="4 Configuration">4 Configuration</h1>
There are a few configuration options for the plugin. All are specified in Config.groovy, some of the configuration could be also done by command line optional argument. Command line argument configuration takes precedence from Config file.<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">Property</strong></th><th><strong class="bold">Default</strong></th><th><strong class="bold">Meaning</strong></th></tr><tr class="table-odd"><td>grails.scaffolding.html.mobile.index</td><td>none, must be specified</td><td>By convention the html file scaffolded is name domainClass-index.htlm where domainClass does not contain package name.</td></tr></table>


                    </div>
                </td>
                <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Scripts</h1><div class="menu-sub">
                        
                        
                        <div class="menu-item"><a href="../ref/Scripts/html-generate-all.html">html-generate-all</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Scripts/html-generate-controllers.html">html-generate-controllers</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Scripts/html-generate-views.html">html-generate-views</a>
                        </div>
                        
                        </div>
                    </div>
                    
                </div>
            </div>
        </td>
            </tr>
        </table>

        <div id="footer">
            
            
        </div>



<script type="text/javascript" src="../js/docs.js"></script>

    </body>
</html>
